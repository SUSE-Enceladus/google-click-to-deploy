actions:

- name: Try to connect to Rancher service
  bashTest:
    script: |
      timeout 120 bash -c '
        until curl -k -H "Connection: close" "https://rancher-svc-controller.$NAMESPACE:10443/v1/eula"
          do sleep 2;
        done'
    expect:
      exitCode:
        equals: 0


- name: Validated webservice active
  bashTest:
    script: |-
      curl -L -k -H "Connection: close" "https://rancher-service-webui.$NAMESPACE:8443/"
    expect:
      stdout:
        contains: <title>Rancher</title>
      exitCode:
        equals: 0
# Un comment following to debug
#- name: Sleep for 120s
#  # allow for poking around in testing container
#  # remove before production
#  bashTest:
#    script: |
#          sleep 120
#    expect:
#      exitCode:
#        equals: 0

