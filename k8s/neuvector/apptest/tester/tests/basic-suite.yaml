actions:

- name: Try to connect to NeuVector service
  bashTest:
    script: |
      timeout 120 bash -c '
        until curl -k -H "Connection: close" "https://neuvector-svc-controller.$NAMESPACE:10443/v1/eula"
          do sleep 2;
        done'
    expect:
      exitCode:
        equals: 0


- name: Validated webservice active
  bashTest:
    script: |-
      curl -L -k -H "Connection: close" "https://neuvector-service-webui.$NAMESPACE:8443/"
    expect:
      stdout:
        contains: <title>NeuVector</title>
      exitCode:
        equals: 0

- name: Sleep for 120s
  # allow for poking around in testing container
  # remove before production
  bashTest:
    script: |
          sleep 120
    expect:
      exitCode:
        equals: 0

